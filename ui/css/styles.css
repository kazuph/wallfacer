/* --- Theme variables --- */
:root, [data-theme="light"] {
  --bg: #f0ede6;
  --bg-raised: #e8e4dc;
  --bg-card: #faf8f4;
  --bg-input: #e8e4dc;
  --text: #1f1d1a;
  --text-secondary: #5c5851;
  --text-muted: #9c9890;
  --accent: #d97757;
  --accent-hover: #c4623f;
  --border: #d4cfc6;
  --shadow: 0 1px 3px rgba(0,0,0,0.07);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.11);
}
[data-theme="dark"] {
  --bg: #1a1917;
  --bg-raised: #211f1c;
  --bg-card: #272420;
  --bg-input: #1e1c19;
  --text: #f0ede6;
  --text-secondary: #a8a49c;
  --text-muted: #6b6762;
  --accent: #d97757;
  --accent-hover: #e08a68;
  --border: #302e2a;
  --shadow: 0 1px 3px rgba(0,0,0,0.35);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.55);
}

::selection { background: rgba(217, 119, 87, 0.35); color: #1f1d1a; }
[data-theme="dark"] ::selection { background: rgba(217, 119, 87, 0.4); color: #f0ede6; }

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height: 1.6;
}

h1, h2, h3, h4, h5, h6 { margin: 0; font-size: inherit; font-weight: inherit; }

/* --- Layout --- */
.column { flex: 1; min-height: 0; overflow-y: auto; }
.col-bg { background: var(--bg-raised); border-radius: 12px; padding: 12px; }

/* Board grid: 4 equal columns on desktop */
.board-grid {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 16px;
  padding: 24px;
}

/* --- Cards --- */
.card {
  cursor: grab;
  transition: transform 0.15s, box-shadow 0.15s;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px;
}
.card:hover { transform: translateY(-1px); box-shadow: var(--shadow-lg); }
.card.sortable-ghost { opacity: 0.4; }
.card.sortable-chosen { box-shadow: var(--shadow-lg); }
.card-actions { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
.card-action-btn {
  padding: 3px 9px; border-radius: 4px; font-size: 11px; font-weight: 500;
  cursor: pointer; border: 1px solid transparent; line-height: 1.5;
  transition: opacity 0.1s;
}
.card-action-btn:hover { opacity: 0.75; }
.card-action-start  { background: #d0ebdc; color: #1a6030; border-color: #a8d9bb; }
.card-action-done   { background: #d0ebdc; color: #1a6030; border-color: #a8d9bb; }
.card-action-resume { background: #dceaf7; color: #2c5f98; border-color: #a8c8ef; }
.card-action-retry  { background: var(--bg-raised); color: var(--text-secondary); border-color: var(--border); }
[data-theme="dark"] .card-action-start  { background: #0e2a1a; color: #45b87a; border-color: #1e4a2e; }
[data-theme="dark"] .card-action-done   { background: #0e2a1a; color: #45b87a; border-color: #1e4a2e; }
[data-theme="dark"] .card-action-resume { background: #1a2d42; color: #6da0dc; border-color: #2a4460; }

/* --- Badges --- */
.badge { padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 500; }
.badge-backlog { background: #e4e0d8; color: #6b6560; }
.badge-in_progress { background: #dceaf7; color: #2c5f98; }
.badge-waiting { background: #f5e6ce; color: #7a5010; }
.badge-committing { background: #f5e6ce; color: #7a5010; }
.badge-done { background: #d0ebdc; color: #1a6030; }
.badge-failed { background: #f5d5d5; color: #8c2020; }
.badge-archived { background: #e4e0d8; color: #6b6560; font-style: italic; }
.badge-cancelled { background: #e8ddf5; color: #5a3d8a; }
[data-theme="dark"] .badge-backlog { background: #2a2820; color: #7a7770; }
[data-theme="dark"] .badge-in_progress { background: #1a2d42; color: #6da0dc; }
[data-theme="dark"] .badge-waiting { background: #352a10; color: #d4a030; }
[data-theme="dark"] .badge-committing { background: #352a10; color: #d4a030; }
[data-theme="dark"] .badge-done { background: #0e2a1a; color: #45b87a; }
[data-theme="dark"] .badge-failed { background: #341414; color: #d46868; }
[data-theme="dark"] .badge-archived { background: #2a2820; color: #7a7770; font-style: italic; }
[data-theme="dark"] .badge-cancelled { background: #2a1e3d; color: #a07ad4; }

/* --- Spinner --- */
.spinner {
  border: 2px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%; width: 16px; height: 16px;
  animation: spin 0.8s linear infinite; display: inline-block;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* --- Modal --- */
.modal-overlay { background: rgba(0,0,0,0.3); backdrop-filter: blur(4px); }
[data-theme="dark"] .modal-overlay { background: rgba(0,0,0,0.6); }
.modal-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 16px; max-width: 760px; width: 100%;
  max-height: 95vh; overflow-y: auto; box-shadow: var(--shadow-lg);
}
.modal-card.modal-wide {
  max-width: min(96vw, 1600px);
  overflow-y: hidden;
}
.modal-wide #modal-body {
  display: flex; gap: 0;
}
.modal-wide #modal-left {
  flex: 2; min-width: 0; overflow-y: auto; max-height: calc(95vh - 80px);
  border-right: 1px solid var(--border); padding-right: 28px; margin-right: 28px;
}
.modal-wide #modal-right {
  flex: 3; min-width: 0; overflow-y: auto; max-height: calc(95vh - 80px);
}
.modal-wide .logs-block {
  max-height: 560px;
}

/* --- Column headers --- */
.col-header { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
.col-header-backlog { color: var(--text-muted); }
.col-header-progress { color: #3a6db3; }
.col-header-waiting { color: #a07020; }
.col-header-done { color: #28804a; }
.col-header-failed { color: #a02828; }
.col-header-cancelled { color: #5a3d8a; }
[data-theme="dark"] .col-header-progress { color: #6da0dc; }
[data-theme="dark"] .col-header-waiting { color: #d4a030; }
[data-theme="dark"] .col-header-done { color: #45b87a; }
[data-theme="dark"] .col-header-failed { color: #d46868; }
[data-theme="dark"] .col-header-cancelled { color: #a07ad4; }

/* --- Event type colors --- */
.ev-state { color: #3a6db3; }
.ev-output { color: #28804a; }
.ev-system { color: #7a6a90; }
.ev-feedback { color: #a07020; }
.ev-error { color: #b02828; }
[data-theme="dark"] .ev-state { color: #6da0dc; }
[data-theme="dark"] .ev-output { color: #45b87a; }
[data-theme="dark"] .ev-system { color: #a090c0; }
[data-theme="dark"] .ev-feedback { color: #d4a030; }
[data-theme="dark"] .ev-error { color: #d46868; }

/* --- Form elements --- */
.field {
  background: var(--bg-input); border: 1px solid var(--border); color: var(--text);
  border-radius: 8px; padding: 12px; font-size: 14px; outline: none; width: 100%;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace; resize: none;
  box-sizing: border-box;
}
.field::placeholder { color: var(--text-muted); }
.field:focus { border-color: var(--accent); }

.select {
  background: var(--bg-input); border: 1px solid var(--border); color: var(--text-secondary);
  border-radius: 4px; padding: 4px 8px; font-size: 12px; outline: none;
}
.select:focus { border-color: var(--accent); }

/* --- Buttons --- */
.btn { border: none; border-radius: 8px; padding: 6px 16px; font-size: 14px; font-weight: 500; cursor: pointer; }
.btn-accent { background: var(--accent); color: #fff; }
.btn-accent:hover { background: var(--accent-hover); }
.btn-yellow { background: #b07820; color: #fff; }
.btn-yellow:hover { background: #8a5c18; }
.btn-green { background: #2a8050; color: #fff; }
.btn-green:hover { background: #20643e; }
.btn-ghost { background: transparent; color: var(--text-muted); border: none; padding: 6px 16px; font-size: 14px; cursor: pointer; }
.btn-ghost:hover { color: var(--text); }
.btn-dashed {
  width: 100%; border: 1px dashed var(--border); border-radius: 8px;
  padding: 8px 12px; font-size: 14px; color: var(--text-muted);
  background: transparent; cursor: pointer;
}
.btn-dashed:hover { color: var(--text-secondary); border-color: var(--text-muted); }
.btn-danger { color: #b02828; background: none; border: none; cursor: pointer; font-size: 14px; }
.btn-danger:hover { color: #8a1e1e; }
[data-theme="dark"] .btn-danger { color: #e07070; }
[data-theme="dark"] .btn-danger:hover { color: #e89090; }

/* --- Code / log blocks --- */
pre { white-space: pre-wrap; word-break: break-word; }
.code-block {
  background: var(--bg-input); border-radius: 8px; padding: 16px;
  font-size: 14px; color: var(--text-secondary);
}
.logs-block {
  background: #131210; border-radius: 8px; padding: 16px;
  font-size: 12px; color: #b1bac4; max-height: 384px;
  overflow-y: auto; font-family: 'SF Mono', 'Fira Code', monospace;
}

/* --- Claude Code terminal style (pretty NDJSON) --- */
.cc-block { margin: 2px 0; line-height: 1.5; }
.cc-marker { color: #79c0ff; margin-right: 6px; }
.cc-marker-result { color: #3fb950; }
.cc-text { color: #b1bac4; white-space: pre-wrap; word-break: break-word; }
.cc-tool-call { color: #b1bac4; }
.cc-tool-name { color: #ff79c6; font-weight: bold; }
.cc-tool-input { color: #e3b341; font-weight: normal; word-break: break-all; }
.cc-tool-result {
  display: flex; align-items: flex-start; gap: 6px;
  padding-left: 18px; color: #8b949e;
}
.cc-result-pipe { color: #484f58; flex-shrink: 0; }
.cc-result-text {
  margin: 0; padding: 0; background: none; font-size: inherit;
  color: inherit; white-space: pre-wrap; word-break: break-word;
  font-family: inherit; line-height: inherit; max-width: 100%; overflow: hidden;
}
.cc-result-empty { color: #484f58; font-style: italic; }
.cc-expand { display: contents; }
.cc-expand-toggle {
  color: #484f58; cursor: pointer; font-size: 11px;
  list-style: none; user-select: none;
}
.cc-expand-toggle:hover { color: #8b949e; }
.cc-expand-toggle::-webkit-details-marker { display: none; }
.cc-final-result {
  color: #3fb950; white-space: pre-wrap; word-break: break-word;
  margin-top: 8px; padding-top: 8px; border-top: 1px solid #484f58;
}
.cc-result-label { font-weight: bold; }
.cc-stderr { color: #8b949e; }

/* --- Usage stats --- */
.usage-grid {
  background: var(--bg-input); border-radius: 8px; padding: 16px;
  display: grid; grid-template-columns: 1fr 1fr; gap: 4px 24px; font-size: 14px;
}
.usage-label { color: var(--text-muted); }
.usage-value { color: var(--text); font-family: 'SF Mono', 'Fira Code', monospace; text-align: right; }

/* --- Settings panel --- */
.settings-panel {
  position: absolute; top: 100%; right: 0; margin-top: 8px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 16px; min-width: 200px;
  box-shadow: var(--shadow-lg); z-index: 100;
}
.settings-btn {
  background: none; border: none; color: var(--text-muted);
  cursor: pointer; padding: 6px; display: flex; align-items: center;
  border-radius: 6px;
}
.settings-btn:hover { color: var(--text); }

.theme-switch {
  display: flex; background: var(--bg-input); border: 1px solid var(--border);
  border-radius: 8px; overflow: hidden;
}
.theme-switch button {
  flex: 1; padding: 6px 0; font-size: 12px; font-weight: 500;
  background: transparent; color: var(--text-muted);
  border: none; cursor: pointer;
}
.theme-switch button.active { background: var(--accent); color: #fff; }
.theme-switch button:hover:not(.active) { color: var(--text); }

/* --- Utility --- */
.text-v-primary { color: var(--text); }
.text-v-secondary { color: var(--text-secondary); }
.text-v-muted { color: var(--text-muted); }
.border-v { border-color: var(--border); }
.section-title { font-size: 16px; font-weight: 600; color: var(--text); margin-bottom: 8px; }

/* --- Icon buttons (toggle/copy) --- */
.btn-icon {
  background: none; border: 1px solid var(--border); color: var(--text-muted);
  border-radius: 5px; padding: 2px 7px; font-size: 11px; cursor: pointer;
  display: inline-flex; align-items: center; gap: 3px; line-height: 1.6;
}
.btn-icon:hover { color: var(--text); border-color: var(--text-muted); }

/* --- Markdown prose (modal detail view) --- */
.prose-content { font-size: 14px; line-height: 1.6; color: var(--text-secondary); }
.prose-content h1, .prose-content h2, .prose-content h3,
.prose-content h4, .prose-content h5, .prose-content h6 {
  font-weight: 600; line-height: 1.3; color: var(--text); margin: 0.75em 0 0.3em;
}
.prose-content h1 { font-size: 1.25em; }
.prose-content h2 { font-size: 1.1em; }
.prose-content h3 { font-size: 1em; }
.prose-content p { margin: 0.4em 0; }
.prose-content p:first-child { margin-top: 0; }
.prose-content p:last-child { margin-bottom: 0; }
.prose-content ul { list-style-type: disc; padding-left: 1.5em; margin: 0.4em 0; }
.prose-content ol { list-style-type: decimal; padding-left: 1.5em; margin: 0.4em 0; }
.prose-content li { margin: 0.15em 0; }
.prose-content code {
  background: var(--bg); border-radius: 4px; padding: 1px 5px; font-size: 0.88em;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace; color: var(--text);
}
.prose-content pre {
  background: var(--bg); border-radius: 6px; padding: 12px; overflow-x: auto;
  margin: 0.5em 0; font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 13px; white-space: pre-wrap; word-break: break-word;
}
.prose-content pre code { background: none; padding: 0; font-size: inherit; }
.prose-content blockquote {
  border-left: 3px solid var(--border); padding-left: 1em;
  color: var(--text-muted); margin: 0.5em 0;
}
.prose-content a { color: var(--accent); text-decoration: none; }
.prose-content a:hover { text-decoration: underline; }
.prose-content hr { border: none; border-top: 1px solid var(--border); margin: 0.75em 0; }
.prose-content table { border-collapse: collapse; width: 100%; margin: 0.5em 0; font-size: 13px; }
.prose-content th, .prose-content td { border: 1px solid var(--border); padding: 5px 10px; text-align: left; }
.prose-content th { background: var(--bg-input); font-weight: 600; color: var(--text); }
.prose-content strong { font-weight: 600; color: var(--text); }

/* --- Behind-branch warning banner --- */
.diff-behind-warning {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  background: #fef9c3;
  border: 1px solid #d97706;
  border-radius: 4px;
  padding: 3px 6px;
  font-size: 9px;
  color: #92400e;
  margin-top: 6px;
  margin-bottom: 2px;
}
[data-theme="dark"] .diff-behind-warning {
  background: rgba(217, 119, 6, 0.15);
  border-color: #b45309;
  color: #fbbf24;
}
.diff-sync-btn {
  flex-shrink: 0;
  padding: 1px 6px;
  font-size: 9px;
  font-weight: 600;
  border-radius: 3px;
  border: 1px solid #d97706;
  background: #fff;
  color: #92400e;
  cursor: pointer;
  line-height: 1.6;
}
.diff-sync-btn:hover {
  background: #fef3c7;
}
[data-theme="dark"] .diff-sync-btn {
  background: rgba(217, 119, 6, 0.2);
  border-color: #b45309;
  color: #fbbf24;
}
[data-theme="dark"] .diff-sync-btn:hover {
  background: rgba(217, 119, 6, 0.35);
}
/* Modal-level behind warning (larger) */
#modal-diff-behind:not(.hidden) {
  display: flex;
}
#modal-diff-behind {
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  background: #fef9c3;
  border: 1px solid #d97706;
  border-radius: 6px;
  padding: 6px 10px;
  font-size: 12px;
  color: #92400e;
  margin-bottom: 10px;
}
[data-theme="dark"] #modal-diff-behind {
  background: rgba(217, 119, 6, 0.15);
  border-color: #b45309;
  color: #fbbf24;
}
#modal-diff-behind .diff-sync-btn {
  font-size: 11px;
  padding: 2px 10px;
}

/* --- Diff block (waiting task cards) --- */
.diff-block {
  background: var(--bg-input);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 4px 6px;
  font-size: 9px;
  line-height: 1.5;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  max-height: 8em;
  overflow-y: auto;
  overflow-x: hidden;
  color: var(--text-secondary);
  white-space: pre-wrap;
  word-break: break-all;
  margin-top: 8px;
}
.diff-add { color: #1a6638; }
.diff-del { color: #8c2424; }
.diff-hunk { color: #2c5b9a; }
.diff-header { color: #7a5810; }
[data-theme="dark"] .diff-add { color: #3fb950; }
[data-theme="dark"] .diff-del { color: #ff7b72; }
[data-theme="dark"] .diff-hunk { color: #79c0ff; }
[data-theme="dark"] .diff-header { color: #e3b341; }

/* --- Diff per-file (modal detail view) --- */
.diff-file {
  border: 1px solid var(--border);
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 4px;
}
.diff-file-summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--bg-input);
  cursor: pointer;
  list-style: none;
  user-select: none;
  position: sticky;
  top: 0;
  z-index: 1;
}
.diff-file-summary::-webkit-details-marker { display: none; }
.diff-file[open] .diff-file-summary { border-bottom: 1px solid var(--border); }
.diff-filename {
  font-size: 13px;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  color: var(--text);
  font-weight: 600;
}
.diff-stats { display: flex; gap: 6px; font-size: 11px; font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace; }
.diff-block-modal {
  padding: 8px 0;
  font-size: 0;
  max-height: none;
  margin-top: 0;
  border: none;
  border-radius: 0;
}
.diff-block-modal .diff-line {
  display: block;
  padding: 0 10px;
  font-size: 12px;
  line-height: 1.5;
}
.diff-block-modal .diff-line.diff-add {
  background: #dafbe1;
  color: #1a6638;
}
.diff-block-modal .diff-line.diff-del {
  background: #ffebe9;
  color: #82071e;
}
.diff-block-modal .diff-line.diff-hunk {
  background: rgba(56,139,253,0.1);
  color: #0550ae;
}
.diff-block-modal .diff-line.diff-header {
  color: var(--text-muted);
}
[data-theme="dark"] .diff-block-modal .diff-line.diff-add {
  background: rgba(46,160,67,0.15);
  color: #3fb950;
}
[data-theme="dark"] .diff-block-modal .diff-line.diff-del {
  background: rgba(248,81,73,0.15);
  color: #ff7b72;
}
[data-theme="dark"] .diff-block-modal .diff-line.diff-hunk {
  background: rgba(56,139,253,0.15);
  color: #79c0ff;
}
[data-theme="dark"] .diff-block-modal .diff-line.diff-header {
  color: var(--text-muted);
}

/* --- Failed tasks displayed in Waiting column --- */
.card-failed-waiting {
  border-left: 3px solid #a02828;
}
[data-theme="dark"] .card-failed-waiting {
  border-left-color: #d46868;
}

/* --- Cancelled tasks displayed in Done column --- */
.card-cancelled-done {
  border-left: 3px solid #5a3d8a;
}
[data-theme="dark"] .card-cancelled-done {
  border-left-color: #a07ad4;
}
.card-error-reason {
  margin-top: 6px;
  padding: 4px 6px;
  background: rgba(140, 32, 32, 0.07);
  border-radius: 4px;
  font-size: 11px;
  line-height: 1.4;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  word-break: break-word;
}
[data-theme="dark"] .card-error-reason {
  background: rgba(212, 104, 104, 0.1);
}
.card-error-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #8c2020;
  margin-right: 6px;
}
[data-theme="dark"] .card-error-label {
  color: #d46868;
}
.card-error-text {
  color: #7a2c2c;
}
[data-theme="dark"] .card-error-text {
  color: #c47070;
}

/* --- Output reason (waiting tasks) --- */
.card-output-reason {
  margin-top: 6px;
  padding: 4px 6px;
  background: rgba(100, 100, 140, 0.07);
  border-radius: 4px;
  font-size: 11px;
  line-height: 1.4;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  word-break: break-word;
}
[data-theme="dark"] .card-output-reason {
  background: rgba(160, 160, 200, 0.1);
}
.card-output-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #555;
  margin-right: 6px;
}
[data-theme="dark"] .card-output-label {
  color: #aaa;
}
.card-output-text {
  color: #444;
}
[data-theme="dark"] .card-output-text {
  color: #bbb;
}

/* --- Error result in live output --- */
.cc-final-error {
  color: #d46868;
  border-top-color: #341414;
}

/* --- Task title (auto-generated 2-5 word summary) --- */
.card-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* --- Markdown in card previews (compact overrides) --- */
.card-prose { }
.card-prose p { margin: 0 !important; }
.card-prose h1, .card-prose h2, .card-prose h3,
.card-prose h4, .card-prose h5, .card-prose h6 { margin: 0 0 0.1em !important; font-size: 1em !important; }
.card-prose ul { list-style-type: disc !important; margin: 0 !important; padding-left: 1.2em !important; }
.card-prose ol { list-style-type: decimal !important; margin: 0 !important; padding-left: 1.2em !important; }
.card-prose li { margin: 0 !important; }
.card-prose pre { margin: 0 !important; padding: 2px 6px !important; font-size: 0.85em !important; }
.card-prose blockquote { margin: 0 !important; }

/* --- Multi-turn result entries --- */
.result-entry {
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 8px;
}
.result-entry:last-child { margin-bottom: 0; }

.result-entry-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--bg-input);
  border-bottom: 1px solid var(--border);
}
.result-entry-summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--bg-input);
  cursor: pointer;
  list-style: none;
  user-select: none;
}
.result-entry-summary::-webkit-details-marker { display: none; }
details.result-entry[open] .result-entry-summary { border-bottom: 1px solid var(--border); }
.result-entry-actions {
  display: flex;
  justify-content: flex-end;
  padding: 6px 12px;
  background: var(--bg-input);
  border-bottom: 1px solid var(--border);
}
.result-entry-body {
  padding: 16px;
  font-size: 14px;
  color: var(--text-secondary);
}
pre.result-entry-body {
  white-space: pre-wrap;
  word-break: break-word;
  font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
}
.result-entry-labels {
  display: flex;
  align-items: center;
  gap: 6px;
}

/* Result type badge */
.result-type-badge {
  padding: 2px 7px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
}
.result-type-plan {
  background: #e8ddf5;
  color: #5a3d8a;
}
[data-theme="dark"] .result-type-plan {
  background: #2a1e3d;
  color: #a07ad4;
}
.result-turn-label {
  font-size: 11px;
  color: var(--text-muted);
}

/* ===== Mobile Column Navigator ===== */
#mobile-col-nav {
  display: none; /* hidden on desktop */
}

/* ===== Mobile Responsive ===== */
@media (max-width: 768px) {
  /* --- Mobile column navigator --- */
  #mobile-col-nav {
    display: flex;
    overflow-x: auto;
    gap: 6px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    background: var(--bg);
    flex-shrink: 0;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  #mobile-col-nav::-webkit-scrollbar { display: none; }

  .mobile-col-btn {
    white-space: nowrap;
    padding: 5px 14px;
    border-radius: 20px;
    border: 1px solid var(--border);
    background: var(--bg-card);
    color: var(--text-secondary);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    flex-shrink: 0;
    transition: background 0.15s, color 0.15s;
  }
  .mobile-col-btn:active { opacity: 0.75; }
  .mobile-col-btn.active {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  /* --- Board: horizontal scroll with snap --- */
  .board-grid {
    display: flex !important;
    flex-direction: row !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    padding: 12px !important;
    gap: 10px !important;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .board-grid::-webkit-scrollbar { display: none; }

  .board-grid > div {
    min-width: calc(100vw - 48px);
    max-width: calc(100vw - 48px);
    flex-shrink: 0;
    scroll-snap-align: start;
  }

  /* --- Header: compact on mobile --- */
  header {
    padding: 10px 14px !important;
    gap: 8px;
    flex-wrap: nowrap;
  }
  header > div:first-child {
    min-width: 0;
    flex: 1;
    overflow: hidden;
  }
  #workspace-list {
    max-width: 140px;
    overflow: hidden;
    flex-wrap: nowrap;
  }

  /* --- Settings panel: stay within viewport --- */
  .settings-panel {
    max-width: calc(100vw - 20px);
    right: 0;
  }

  /* --- Modals: bottom-sheet on mobile --- */
  .modal-overlay {
    align-items: flex-end !important;
    padding: 0 !important;
  }
  .modal-card {
    border-radius: 16px 16px 0 0 !important;
    max-height: 92vh !important;
    max-width: 100% !important;
    width: 100% !important;
  }
  .modal-card.modal-wide {
    max-width: 100% !important;
    overflow-y: auto !important;
  }

  /* Reduce modal inner padding on mobile */
  .modal-card .p-6 {
    padding: 16px !important;
  }

  /* Stack wide modal panels (left + right) vertically */
  .modal-wide #modal-body {
    flex-direction: column !important;
  }
  .modal-wide #modal-left {
    border-right: none !important;
    padding-right: 0 !important;
    margin-right: 0 !important;
    border-bottom: 1px solid var(--border) !important;
    padding-bottom: 16px !important;
    margin-bottom: 16px !important;
    max-height: none !important;
    overflow-y: visible !important;
  }
  .modal-wide #modal-right {
    max-height: none !important;
    overflow-y: visible !important;
  }
  .modal-wide .logs-block {
    max-height: 300px;
  }

  /* Larger touch targets for interactive elements */
  .btn, .btn-ghost, .btn-dashed {
    min-height: 36px;
  }
  .btn-yellow, .btn-green, .btn-accent {
    min-height: 36px;
  }


}
